# Create a thinline-radio subfolder under the DOCUMENT_ROOT and put this file in it.
# Don't forget to change 127.0.0.1:3000 to the internal IP of your Thinline Radio instance.

DirectoryIndex index.html

RewriteEngine on

# Set forwarding headers so the backend server knows the original protocol and host
# This is critical for proper HTTPS detection when using SSL termination at the proxy
# Note: If using ProxyPreserveHost On in your Apache VirtualHost config, you only need X-Forwarded-Proto
RequestHeader set X-Forwarded-Proto "https" env=HTTPS
RequestHeader set X-Forwarded-Proto "http" env=!HTTPS

RewriteCond %{HTTP:CONNECTION} ^upgrade$ [NC,OR]
RewriteCond %{HTTP:UPGRADE} ^websocket$ [NC]
RewriteRule ^/?(.*)$ ws://127.0.0.1:3000/$1 [P,L]
RewriteRule ^/?(.*)$ http://127.0.0.1:3000/$1 [P,L] 